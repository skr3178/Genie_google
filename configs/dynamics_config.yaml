# Dynamics Model Configuration
# Scaled down for 16GB GPU

model:
  name: "dynamics"
  
  architecture:
    num_layers: 12
    d_model: 768
    num_heads: 12
    k_q_size: 128
    dim_feedforward: 3072  # 4 * d_model
    dropout: 0.1
    activation: "gelu"
    qk_normalization: true
  
  token_embedding:
    vocab_size: 1024  # From video tokenizer
    embedding_dim: 768
  
  action_embedding:
    num_actions: 8
    embedding_dim: 768

data:
  sequence_length: 16
  batch_size: 4
  num_workers: 4

training:
  max_lr: 3.0e-5
  min_lr: 3.0e-6
  beta1: 0.9
  beta2: 0.9
  weight_decay: 1.0e-4
  warmup_steps: 1000  # Scaled from 5k
  max_steps: 10000  # Scaled from 125k
  lr_schedule: "cosine"
  
  # MaskGIT training
  mask_prob: 0.5  # Bernoulli rate 0.5-1.0
  min_mask_prob: 0.5
  max_mask_prob: 1.0
  
  # Training settings
  mixed_precision: true
  gradient_checkpointing: true
  max_grad_norm: 1.0
  save_every: 2000
  eval_every: 500

inference:
  maskgit_steps: 25
  temperature: 2.0
  sampling: "random"

output:
  checkpoint_dir: "checkpoints/dynamics"
  log_dir: "logs/dynamics"
